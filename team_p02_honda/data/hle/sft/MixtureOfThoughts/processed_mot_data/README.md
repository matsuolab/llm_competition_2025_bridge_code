---
configs:
- config_name: math
  data_files: "data/math_MoT_math.parquet"
- config_name: science
  data_files: "data/science_MoT_science.parquet"
- config_name: code
  data_files: "data/code_MoT_code.parquet"
---

# CoT_MixtureOfThoughts
# Mixture of Thoughts (MoT) データセット - データカード

## データセットの概要

このデータカードは、処理済みMixture of Thoughtsデータセットについて説明しています。このデータセットは、元の[open-r1/Mixture-of-Thoughts](https://huggingface.co/datasets/open-r1/Mixture-of-Thoughts)データセットから、言語モデルの教師ありファインチューニング（SFT）に適した構造化フォーマットに変換されたものです。

## データセット処理

**処理スクリプト**: `process_mot_dataset.py`  
**元データセット**: open-r1/Mixture-of-Thoughts  
**処理日**: プログラム的に生成  

### 処理パイプライン

データセットは以下の変換を行います：

1. **分割処理**: 3つのドメイン固有の分割を処理：`code`、`math`、`science`
2. **会話抽出**: 各会話から最初のユーザー-アシスタントメッセージペアを抽出
3. **解答解析**: `<think>...</think>`タグから推論過程と最終回答を抽出
4. **データ検証**: 不正な会話や無効なJSON構造をフィルタリング
5. **フォーマット標準化**: 一意の識別子を持つ一貫したJSON構造に変換

## データセット統計

| 分割 | レコード数 | ファイルサイズ（概算） | 出力ファイル |
|------|-----------|---------------------|-------------|
| Code | 83,070 | ~3.8 GB | `MoT_code.json` |
| Math | 93,733 | ~2.1 GB | `MoT_math.json` |
| Science | 172,514 | ~3.9 GB | `MoT_science.json` |
| **合計** | **349,317** | **~9.8 GB** | |

## データ構造

各レコードには以下のフィールドが含まれます：

```json
{
  "id": "MoT_{split_name}_{index}",
  "question": "ユーザーの入力/質問",
  "output": "<think>...</think>タグから抽出された推論（nullの場合あり）",
  "answer": "</think>タグ後の最終回答（nullの場合あり）"
}
```

### フィールド説明

- **`id`**: `MoT_{分割}_{インデックス}`のパターンに従う一意識別子
- **`question`**: 会話からの元のユーザー質問またはプロンプト
- **`output`**: `<think>...</think>`タグから抽出された推論過程（存在しない場合はnull）
- **`answer`**: `</think>`タグ後の最終回答内容（存在しない場合はnull）

## ドメインカバレッジ

### Code分割（83,070レコード）
- **内容**: プログラミング問題、アルゴリズム、コード最適化
- **言語**: 主にC++17、Python 3、その他の言語も一部含む
- **トピック**: 競技プログラミング、データ構造、アルゴリズム、実装チャレンジ
- **使用例**: コード生成、アルゴリズム説明、プログラミングチュートリアル

### Math分割（93,733レコード）
- **内容**: 数学問題と解答
- **トピック**: 代数、幾何、数論、確率、微積分
- **フォーマット**: 最終的な数値/記号回答を持つ段階的数学推論
- **使用例**: 数学指導、問題解決、数学的推論

### Science分割（172,514レコード）
- **内容**: 科学的質問と説明
- **ドメイン**: 物理学、化学、生物学、地球科学
- **フォーマット**: 説明と結論を含む科学的推論
- **使用例**: 科学教育、研究支援、概念説明

## データ品質と特性

### 推論構造
- **思考の連鎖**: 解答には`<think>`タグ内の明示的な推論ステップが含まれる
- **二部構成の回答**: 内部推論（`output`）と最終回答（`answer`）が分離
- **可変長**: 推論過程の長さと複雑さは大きく異なる

### データ整合性
- **検証**: 不正な会話と無効なJSONは自動的にフィルタリング
- **完全性**: 解析に失敗した場合、一部のレコードで`output`または`answer`フィールドがnullになる可能性
- **一貫性**: すべてのレコードが分割を跨いで同じ構造フォーマットに従う

### 内容特性
- **言語**: 主に英語
- **品質**: 詳細な説明を含む高品質な推論
- **複雑性**: 基本から上級レベルの問題まで幅広い範囲
- **フォーマット**: 指示チューニングに適した構造化Q&Aフォーマット

## 想定される使用ケース

### 主要なアプリケーション
1. **教師ありファインチューニング**: 推論タスクでの言語モデル訓練
2. **思考の連鎖訓練**: モデルに推論過程を示すことを教える
3. **ドメイン固有訓練**: コード、数学、科学ドメインの専門訓練
4. **指示に従う**: 特定の出力フォーマットに従うようモデルを訓練

### 訓練設定
- **入力**: `question`フィールドをモデル入力として使用
- **ターゲット**: 訓練目的に応じて`output` + `answer`または`answer`のみを使用
- **フォーマット**: 様々な指示に従うフォーマットに適応可能

## 制限事項と考慮事項

### データの制限
- **ソース依存**: 品質は元のMixture-of-Thoughtsデータセットに依存
- **解析制限**: `<think>`タグで適切にフォーマットされていない場合、一部の推論が失われる可能性
- **Null値**: 一部のレコードで推論や回答が不完全
- **ドメインバランス**: Science分割がcode/math分割よりも大幅に大きい

### 倫理的考慮事項
- **コンテンツレビュー**: 処理済みデータは潜在的な偏見や不適切な内容について確認が必要
- **教育的使用**: 主に教育と研究目的で設計
- **帰属**: open-r1/Mixture-of-Thoughtsデータセットから派生

### 技術的制限
- **ファイルサイズ**: 大きなファイルサイズでストリーミングまたはチャンク処理が必要な場合あり
- **メモリ要件**: 完全なデータセット読み込みには大量のRAMが必要
- **処理時間**: 大規模データセットは訓練時に分散処理が必要な場合あり

## 使用ガイドライン

### データセットの読み込み
```python
import json

# 特定の分割を読み込む
with open('processed_mot_data/code/MoT_code.json', 'r') as f:
    code_data = json.load(f)

# レコードを処理
for record in code_data:
    question = record['question']
    reasoning = record['output']  # Noneの場合あり
    answer = record['answer']     # Noneの場合あり
```

### 訓練における考慮事項
- **データフィルタリング**: 訓練ニーズに基づき、null `output`や`answer`を持つレコードのフィルタリングを検討
- **トークン化**: 生のコンテンツを使用する場合、`<think>`などの特殊トークンを考慮
- **バッチ処理**: メモリ効率のためストリーミングまたはチャンク読み込みを使用

## バージョン情報

- **データセットバージョン**: 元のMixture-of-Thoughtsデータセットから処理
- **処理スクリプトバージョン**: `process_mot_dataset.py`での実装
- **出力フォーマットバージョン**: 1.0
- **最終更新**: 処理スクリプトによる生成

## 連絡先とサポート

この処理済みデータセットに関する質問：
- 処理スクリプトを確認: `process_mot_dataset.py`
- 元のデータセットを確認: [open-r1/Mixture-of-Thoughts](https://huggingface.co/datasets/open-r1/Mixture-of-Thoughts)
- 親ディレクトリのプロジェクトドキュメントを参照

---

*このデータカードは`process_mot_dataset.py`の分析と結果として生成された処理済みデータセットファイルに基づいて生成されました。*